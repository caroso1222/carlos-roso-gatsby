{"componentChunkName":"component---src-templates-blog-post-js","path":"/setup-github-ssh-access-from-jenkins/","result":{"data":{"markdownRemark":{"html":"<p>I recently enabled 2FA in my <a href=\"https://github.com/caroso1222\" target=\"_blank\" rel=\"nofollow\">Github account</a> which caused Jenkins to stop <a href=\"../deploying-frontend-applications-the-fun-way/\">deploying my personal apps</a>. This was expected because I was authenticating with plain credentials from Jenkins. Here’s how I changed my pipelines to authenticate with SSH keys instead.</p>\n<ol>\n<li>Get your server’s default SSH public key. In my case, Jenkins runs under the <code class=\"language-text\">jenkins</code> user.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ su - jenkins\n$ cat ~/.ssh/id_rsa.pub</code></pre></div>\n<p>Copy the content in your clipboard.</p>\n<ol start=\"2\">\n<li>Go to your Github account. Visit <a href=\"https://github.com/settings/keys\" target=\"_blank\" rel=\"nofollow\">“SSH and GPG keys”</a>.</li>\n<li>Click on “New SSH key”. Set <strong>Title</strong> to <em>Jenkins SSH</em>. Paste your key in the <strong>Key</strong> textarea.</li>\n<li>Now go to your Jenkins and visit “Credentials”.</li>\n<li>Click the “(global)” link.</li>\n<li>Click on “Add Credentials”.</li>\n<li>Use the following values for each field:\n<ul>\n<li><strong>Kind:</strong> SSH Username with private key</li>\n<li><strong>Scope:</strong> Global (Jenkins, nodes, items, all child items, etc)</li>\n<li><strong>Username:</strong> jenkins</li>\n<li><strong>Private key:</strong> From the Jenkins master ~/.ssh</li>\n<li><strong>Description:</strong> Jenkins SSH key</li>\n</ul>\n</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 662px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/62e39cd869527c4342da0b5e97cd9d18/76823/jenkins-config.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.27710843373494%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABdklEQVQ4y4VT7ZJEMBD0/s94PxTLEazIiq8k+q5jg9riLlVNjOiZ6R5RXdfoug5N06Bt2x3P59PHpJQwxsBaewvnHOZ59ogYGIYBQghUVYWyLD0RwRgT8sy6rpcIpCSz1iAC4AMkYCauJEmQ5znSNPUJ+Mw9kWUZ4jj2scfjgdfrhXV1kLLDV1ofhEopD2bq+x5aa4zj6DFN0y2WZdkr1OO8EVIjakUtScBKuA8rtMcOrtpmfOtuPQiDbqyu13qvmM/ndSb4BN9F4RBJNzcNlJLeEOpIU6gTjWMCngnfXK3o84VxQCxG1JVAKQSKovBGEEzAcbpaSSFhndsqZLlh1ox1UIOF1lvrrE6/JaAJ3IfZO6NVw0HIAxyPPP9GJyWw3ot/nr0z+I1vmRdaT9tDtdwzFhD0/QvzvKCR+nD5TPi57lzd3XUOizHIK3VUGH47akbxaQL/BJryV2XL+z5NMzLRHWNz1iPMIIebCf6r0JtqLerfln8AN6tDNEQAckwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"jenkins config\"\n        title=\"jenkins config\"\n        src=\"/static/62e39cd869527c4342da0b5e97cd9d18/be86f/jenkins-config.png\"\n        srcset=\"/static/62e39cd869527c4342da0b5e97cd9d18/e72ac/jenkins-config.png 166w,\n/static/62e39cd869527c4342da0b5e97cd9d18/62452/jenkins-config.png 331w,\n/static/62e39cd869527c4342da0b5e97cd9d18/be86f/jenkins-config.png 662w,\n/static/62e39cd869527c4342da0b5e97cd9d18/0f7d5/jenkins-config.png 993w,\n/static/62e39cd869527c4342da0b5e97cd9d18/76823/jenkins-config.png 1038w\"\n        sizes=\"(max-width: 662px) 100vw, 662px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol start=\"8\">\n<li>Hit “OK” and go back.</li>\n<li>Grab the ID of the recently created credentials.</li>\n<li>Use the new ID in your pipeline script. Here’s what my script looks like. Notice how I use the new credential’s ID in the property <strong>credentialsId</strong>:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"groovy\"><pre style=\"counter-reset: linenumber 0\" class=\"language-groovy line-numbers\"><code class=\"language-groovy\"><span class=\"token shebang comment\">#!/usr/bin/env groovy</span>\n\nnode <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">def</span> app\n\n  <span class=\"token function\">stage</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">\"Clone\"</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    git branch<span class=\"token punctuation\">:</span> <span class=\"token string\">'master'</span><span class=\"token punctuation\">,</span>\n    credentialsId<span class=\"token punctuation\">:</span> <span class=\"token string\">'13171411-1a23-5e67-a8e9-f11e22221ec7'</span><span class=\"token punctuation\">,</span>\n    url<span class=\"token punctuation\">:</span> <span class=\"token string\">'git@github.com:caroso1222/carlos-roso-gatsby.git'</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">stage</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">\"Build\"</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    app <span class=\"token operator\">=</span> docker<span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">\"caroso1222/carlos-roso-gatsby\"</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">stage</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">\"Deploy\"</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">...</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>There you have it. You’re good to build your pipelines in a real secure way.</p>","frontmatter":{"title":"Setup Github SSH access from Jenkins","description":"Stop authenticating with plain passwords","meta":null,"date":"January 06, 2021"}}},"pageContext":{"slug":"/setup-github-ssh-access-from-jenkins/","previous":{"fields":{"slug":"/how-to-fix-droplet-100-disk-usage-docker/"},"frontmatter":{"title":"How to fix droplet 100% disk usage"}},"next":{"fields":{"slug":"/why-i-left-toptal-for-amazon/"},"frontmatter":{"title":"Why I left Toptal for Amazon"}}}},"staticQueryHashes":["3649515864","63159454"]}